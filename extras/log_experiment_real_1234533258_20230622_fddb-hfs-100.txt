DEMONSTRATION OF "FAST REAL BOOST WITH BINS": AN ENSEMBLE CLASSIFIER FOR FAST PREDICTIONS IMPLEMENTED IN PYTHON VIA NUMBA.JIT AND NUMBA.CUDA.
MAIN-EXPERIMENTER STARTING...]
CPU AND SYSTEM PROPS: {'cpu_name': 'Intel(R) Core(TM) i7-10700 CPU @ 2.90GHz', 'ram_size': '125.7 GB', 'os_name': 'Linux 5.15.0-71-generic', 'os_version': '#78~20.04.1-Ubuntu SMP Wed Apr 19 11:26:48 UTC 2023', 'os_machine': 'x86_64'}
GPU PROPS: {'name': 'NVIDIA GeForce RTX 3090', 'max_threads_per_block': 1024, 'max_block_dim_x': 1024, 'max_block_dim_y': 1024, 'max_block_dim_z': 64, 'max_grid_dim_x': 2147483647, 'max_grid_dim_y': 65535, 'max_grid_dim_z': 65535, 'max_shared_memory_per_block': 49152, 'async_engine_count': 2, 'can_map_host_memory': 1, 'multiprocessor_count': 82, 'warp_size': 32, 'unified_addressing': 1, 'pci_bus_id': 1, 'pci_device_id': 0, 'compute_capability': (8, 6), 'cores_per_SM': 128, 'cores_total': 10496}
[data kind: real, real data flags: [False, False, False, True, False, False, False], clfs flags: [False, False, True, False, True], seed: 0]
EXPERIMENTER REAL DATA...
[experiment hash string: real_1234533258_20230622]
[data definitions:]
[data def 0 (active: False): (name short: 'fddb-patches', reading function: read_data_fddb_patches(), name full: 'FDDB-PATCHES (3NPI))']
[data def 1 (active: False): (name short: 'cifar-10', reading function: read_data_cifar_10(), name full: 'CIFAR-10 (AIRPLANE))']
[data def 2 (active: False): (name short: 'mnist-b', reading function: read_data_mnist_b(), name full: 'MNIST-B (DIGIT 0))']
[data def 3 (active: True): (name short: 'fddb-hfs-100', reading function: read_data_fddb_haar_npi_100(), name full: 'FDDB-HFs (100NPI))']
[data def 4 (active: False): (name short: 'fddb-hfs-300', reading function: read_data_fddb_haar_300(), name full: 'FDDB-HFs (300NPI))']
[data def 5 (active: False): (name short: 'hagrid-hfs-10', reading function: read_data_hagrid_npi_10(), name full: 'HaGRID-HFs (PALM, 10NPI))']
[data def 6 (active: False): (name short: 'hagrid-hfs-30', reading function: read_data_hagrid_haar_30(), name full: 'HaGRID-HFs (PALM, 30NPI))']
[clfs definitions:]
[clf def 0 (active: False): AdaBoostClassifier({'algorithm': 'SAMME.R'})]
[clf def 1 (active: False): GradientBoostingClassifier({'max_depth': 1})]
[clf def 2 (active: True): HistGradientBoostingClassifier({'max_depth': 1, 'early_stopping': False})]
[clf def 3 (active: False): FastRealBoostBins({'fit_mode': 'numba_jit', 'decision_function_mode': 'numba_jit'})]
[clf def 4 (active: True): FastRealBoostBins({'fit_mode': 'numba_cuda', 'decision_function_mode': 'numba_cuda'})]
[other settings -> Ts: [16, 32, 64, 128, 256, 512, 1024], Bs: [8], seed: 0]
UNPICKLE OBJECTS... [from file: ../data/data_face_n_18225_S_5_P_5_NPI_100_SEED_0.bin]
UNPICKLE OBJECTS DONE. [time: 89.52660703659058 s]
====================================================================================================================================================================================================
[experiment: 1/7, params: ('FDDB-HFs (100NPI)', 16, 8)]
[description: {'T': 16, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=16)]
[fit...]
[fit done; time: 285.3639087677002 s]
[predict train...]
[predict train done; time: 3.762578248977661 s, acc: 0.9843426203085425]
[predict test...]
[predict test done; time: 0.41226840019226074 s, acc: 0.9837332677511155]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=16, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 249.4519681930542 s]
[predict train...]
[predict train done; time: 0.06688117980957031 s, acc: 0.989381379998465]
[predict test...]
[predict test done; time: 0.006482839584350586 s, acc: 0.9897410673505955]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 1/7 ({'T': 16, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=16)]
[0: {'time_fit': [285.3639087677002, 1.0], 'time_predict_train': [3.762578248977661, 1.0], 'time_predict_test': [0.41226840019226074, 1.0], 'acc_train': [0.9843426203085425, 1.0051189083820664], 'acc_test': [0.9837332677511155, 1.0061071428571429]}]
[1: FastRealBoostBins(T=16, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [249.4519681930542, 1.1439633482741385], 'time_predict_train': [0.06688117980957031, 56.25765364323399], 'time_predict_test': [0.006482839584350586, 63.59379941892538], 'acc_train': [0.989381379998465, 1.0], 'acc_test': [0.9897410673505955, 1.0]}]
====================================================================================================================================================================================================
[experiment: 2/7, params: ('FDDB-HFs (100NPI)', 32, 8)]
[description: {'T': 32, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=32)]
[fit...]
[fit done; time: 309.00260639190674 s]
[predict train...]
[predict train done; time: 3.944216251373291 s, acc: 0.9843426203085425]
[predict test...]
[predict test done; time: 0.43140697479248047 s, acc: 0.9837332677511155]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=32, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 328.45180344581604 s]
[predict train...]
[predict train done; time: 0.1182718276977539 s, acc: 0.991100621690076]
[predict test...]
[predict test done; time: 0.010271310806274414 s, acc: 0.9909707339352845]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 2/7 ({'T': 32, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=32)]
[0: {'time_fit': [309.00260639190674, 1.0629418543778948], 'time_predict_train': [3.944216251373291, 1.0], 'time_predict_test': [0.43140697479248047, 1.0], 'acc_train': [0.9843426203085425, 1.0068654970760234], 'acc_test': [0.9837332677511155, 1.0073571428571428]}]
[1: FastRealBoostBins(T=32, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [328.45180344581604, 1.0], 'time_predict_train': [0.1182718276977539, 33.348738479402016], 'time_predict_test': [0.010271310806274414, 42.001160604442795], 'acc_train': [0.991100621690076, 1.0], 'acc_test': [0.9909707339352845, 1.0]}]
====================================================================================================================================================================================================
[experiment: 3/7, params: ('FDDB-HFs (100NPI)', 64, 8)]
[description: {'T': 64, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=64)]
[fit...]
[fit done; time: 349.26662516593933 s]
[predict train...]
[predict train done; time: 4.031199216842651 s, acc: 0.9863458438867142]
[predict test...]
[predict test done; time: 0.43946385383605957 s, acc: 0.9857358676176088]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=64, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 479.8367099761963 s]
[predict train...]
[predict train done; time: 0.2183072566986084 s, acc: 0.992006293652621]
[predict test...]
[predict test done; time: 0.018224716186523438 s, acc: 0.99177880054808]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 3/7 ({'T': 64, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=64)]
[0: {'time_fit': [349.26662516593933, 1.3738407148069818], 'time_predict_train': [4.031199216842651, 1.0], 'time_predict_test': [0.43946385383605957, 1.0], 'acc_train': [0.9863458438867142, 1.0057388083510361], 'acc_test': [0.9857358676176088, 1.0061303774459138]}]
[1: FastRealBoostBins(T=64, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [479.8367099761963, 1.0], 'time_predict_train': [0.2183072566986084, 18.465713315284166], 'time_predict_test': [0.018224716186523438, 24.11361852433281], 'acc_train': [0.992006293652621, 1.0], 'acc_test': [0.99177880054808, 1.0]}]
====================================================================================================================================================================================================
[experiment: 4/7, params: ('FDDB-HFs (100NPI)', 128, 8)]
[description: {'T': 128, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=128)]
[fit...]
[fit done; time: 433.73261404037476 s]
[predict train...]
[predict train done; time: 4.380617380142212 s, acc: 0.9889707575408704]
[predict test...]
[predict test done; time: 0.47849202156066895 s, acc: 0.9887222007518532]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=128, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 786.9675114154816 s]
[predict train...]
[predict train done; time: 0.42446374893188477 s, acc: 0.9929196408012895]
[predict test...]
[predict test done; time: 0.034955501556396484 s, acc: 0.9923058005129466]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 4/7 ({'T': 128, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=128)]
[0: {'time_fit': [433.73261404037476, 1.8144070469697844], 'time_predict_train': [4.380617380142212, 1.0], 'time_predict_test': [0.47849202156066895, 1.0], 'acc_train': [0.9889707575408704, 1.0039929221671207], 'acc_test': [0.9887222007518532, 1.0036244758723616]}]
[1: FastRealBoostBins(T=128, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [786.9675114154816, 1.0], 'time_predict_train': [0.42446374893188477, 10.320356900125258], 'time_predict_test': [0.034955501556396484, 13.688604089650374], 'acc_train': [0.9929196408012895, 1.0], 'acc_test': [0.9923058005129466, 1.0]}]
====================================================================================================================================================================================================
[experiment: 5/7, params: ('FDDB-HFs (100NPI)', 256, 8)]
[description: {'T': 256, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=256)]
[fit...]
[fit done; time: 604.1344225406647 s]
[predict train...]
[predict train done; time: 5.106636047363281 s, acc: 0.9910046818635352]
[predict test...]
[predict test done; time: 0.5532996654510498 s, acc: 0.9909707339352845]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=256, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 1403.8654251098633 s]
[predict train...]
[predict train done; time: 0.7992384433746338 s, acc: 0.9943894389438944]
[predict test...]
[predict test done; time: 0.06423449516296387 s, acc: 0.9930787337947511]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 5/7 ({'T': 256, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=256)]
[0: {'time_fit': [604.1344225406647, 2.3237633426116657], 'time_predict_train': [5.106636047363281, 1.0], 'time_predict_test': [0.5532996654510498, 1.0], 'acc_train': [0.9910046818635352, 1.0034154804132653], 'acc_test': [0.9909707339352845, 1.002127206977239]}]
[1: FastRealBoostBins(T=256, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [1403.8654251098633, 1.0], 'time_predict_train': [0.7992384433746338, 6.389377400067835], 'time_predict_test': [0.06423449516296387, 8.613746617721839], 'acc_train': [0.9943894389438944, 1.0], 'acc_test': [0.9930787337947511, 1.0]}]
====================================================================================================================================================================================================
[experiment: 6/7, params: ('FDDB-HFs (100NPI)', 512, 8)]
[description: {'T': 512, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=512)]
[fit...]
[fit done; time: 939.9060580730438 s]
[predict train...]
[predict train done; time: 6.535848140716553 s, acc: 0.992674034845345]
[predict test...]
[predict test done; time: 0.7042162418365479 s, acc: 0.9925868671608755]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=512, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 2627.7265677452087 s]
[predict train...]
[predict train done; time: 1.6141598224639893 s, acc: 0.9967840970143526]
[predict test...]
[predict test done; time: 0.12912893295288086 s, acc: 0.9932895337806977]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 6/7 ({'T': 512, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=512)]
[0: {'time_fit': [939.9060580730438, 2.7957331960733014], 'time_predict_train': [6.535848140716553, 1.0], 'time_predict_test': [0.7042162418365479, 1.0], 'acc_train': [0.992674034845345, 1.0041403945552458], 'acc_test': [0.9925868671608755, 1.0007079144839304]}]
[1: FastRealBoostBins(T=512, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [2627.7265677452087, 1.0], 'time_predict_train': [1.6141598224639893, 4.049071256611805], 'time_predict_test': [0.12912893295288086, 5.453589878989524], 'acc_train': [0.9967840970143526, 1.0], 'acc_test': [0.9932895337806977, 1.0]}]
====================================================================================================================================================================================================
[experiment: 7/7, params: ('FDDB-HFs (100NPI)', 1024, 8)]
[description: {'T': 1024, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=1024)]
[fit...]
[fit done; time: 1613.2069158554077 s]
[predict train...]
[predict train done; time: 9.46652340888977 s, acc: 0.9940018420446696]
[predict test...]
[predict test done; time: 1.0181615352630615 s, acc: 0.9935706004286267]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=1024, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 5079.104604482651 s]
[predict train...]
[predict train done; time: 3.16949200630188 s, acc: 0.9998234707191649]
[predict test...]
[predict test done; time: 0.26132702827453613 s, acc: 0.9936760004216]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 7/7 ({'T': 1024, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=1024)]
[0: {'time_fit': [1613.2069158554077, 3.148452039575742], 'time_predict_train': [9.46652340888977, 1.0], 'time_predict_test': [1.0181615352630615, 1.0], 'acc_train': [0.9940018420446696, 1.0058567584367049], 'acc_test': [0.9935706004286267, 1.000106082036775]}]
[1: FastRealBoostBins(T=1024, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [5079.104604482651, 1.0], 'time_predict_train': [3.16949200630188, 2.9867636170299674], 'time_predict_test': [0.26132702827453613, 3.8961202826423134], 'acc_train': [0.9998234707191649, 1.0], 'acc_test': [0.9936760004216, 1.0]}]
[about to generate wanted plots]
EXPERIMENT REAL DATA DONE. [time: 15627.770875930786 s, hash string: real_1234533258_20230622]
MAIN-EXPERIMENTER DONE.