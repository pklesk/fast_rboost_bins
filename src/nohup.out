2023-06-21 09:27:10.108433: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-21 09:27:10.639753: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
DEMONSTRATION OF "FAST REAL BOOST WITH BINS": AN ENSEMBLE CLASSIFIER IMPLEMENTED IN PYTHON VIA NUMBA.JIT AND NUMBA.CUDA.
CPU AND SYSTEM PROPS: {'cpu_name': 'Intel(R) Core(TM) i7-10700 CPU @ 2.90GHz', 'ram_size': '125.7 GB', 'os_name': 'Linux 5.15.0-71-generic', 'os_version': '#78~20.04.1-Ubuntu SMP Wed Apr 19 11:26:48 UTC 2023', 'os_machine': 'x86_64'}
GPU PROPS: {'name': 'NVIDIA GeForce RTX 3090', 'max_threads_per_block': 1024, 'max_block_dim_x': 1024, 'max_block_dim_y': 1024, 'max_block_dim_z': 64, 'max_grid_dim_x': 2147483647, 'max_grid_dim_y': 65535, 'max_grid_dim_z': 65535, 'max_shared_memory_per_block': 49152, 'async_engine_count': 2, 'can_map_host_memory': 1, 'multiprocessor_count': 82, 'warp_size': 32, 'unified_addressing': 1, 'pci_bus_id': 1, 'pci_device_id': 0, 'compute_capability': (8, 6), 'cores_per_SM': 128, 'cores_total': 10496}
MAIN (EXPERIMENTER) STARTING...]
[data kind: real, real data flags: [False, True, False, False, False, False, False], clfs flags: [True, True, True, True, True], seed: 0]
EXPERIMENTER REAL DATA...
[experiment hash string: real_0822149182_20230621]
[data definitions:]
[data def 0 (active: False): (name short: 'fddb-patches', reading function: read_data_fddb_patches(), name full: 'FDDB-PATCHES (3NPI))']
[data def 1 (active: True): (name short: 'cifar-10', reading function: read_data_cifar_10(), name full: 'CIFAR-10 (AIRPLANE))']
[data def 2 (active: False): (name short: 'mnist-b', reading function: read_data_mnist_b(), name full: 'MNIST-B (DIGIT 0))']
[data def 3 (active: False): (name short: 'fddb-hfs-100', reading function: read_data_fddb_haar_npi_100(), name full: 'FDDB-HFs (100NPI))']
[data def 4 (active: False): (name short: 'fddb-hfs-300', reading function: read_data_fddb_haar_300(), name full: 'FDDB-HFs (300NPI))']
[data def 5 (active: False): (name short: 'hagrid-hfs-10', reading function: read_data_hagrid_npi_10(), name full: 'HaGRID-HFs (PALM, 10NPI))']
[data def 6 (active: False): (name short: 'hagrid-hfs-30', reading function: read_data_hagrid_haar_30(), name full: 'HaGRID-HFs (PALM, 30NPI))']
[clfs definitions:]
[clf def 0 (active: True): AdaBoostClassifier({'algorithm': 'SAMME.R'})]
[clf def 1 (active: True): GradientBoostingClassifier({'max_depth': 1})]
[clf def 2 (active: True): HistGradientBoostingClassifier({'max_depth': 1, 'early_stopping': False})]
[clf def 3 (active: True): FastRealBoostBins({'fit_mode': 'numba_jit', 'decision_function_mode': 'numba_jit'})]
[clf def 4 (active: True): FastRealBoostBins({'fit_mode': 'numba_cuda', 'decision_function_mode': 'numba_cuda'})]
[other settings -> Ts: [16, 32, 64, 128, 512, 1024], Bs: [8], seed: 0]
Downloading data from https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz
     8192/170498071 [..............................] - ETA: 0s    40960/170498071 [..............................] - ETA: 7:37    98304/170498071 [..............................] - ETA: 6:21   212992/170498071 [..............................] - ETA: 4:23   434176/170498071 [..............................] - ETA: 2:43   843776/170498071 [..............................] - ETA: 1:37   892928/170498071 [..............................] - ETA: 1:44  1777664/170498071 [..............................] - ETA: 1:00  3391488/170498071 [..............................] - ETA: 34s   3612672/170498071 [..............................] - ETA: 35s  6316032/170498071 [>.............................] - ETA: 22s  9355264/170498071 [>.............................] - ETA: 17s 12451840/170498071 [=>............................] - ETA: 14s 15589376/170498071 [=>............................] - ETA: 12s 18726912/170498071 [==>...........................] - ETA: 10s 21856256/170498071 [==>...........................] - ETA: 9s  24920064/170498071 [===>..........................] - ETA: 9s 27951104/170498071 [===>..........................] - ETA: 8s 31064064/170498071 [====>.........................] - ETA: 8s 34127872/170498071 [=====>........................] - ETA: 7s 37224448/170498071 [=====>........................] - ETA: 7s 40321024/170498071 [======>.......................] - ETA: 6s 43442176/170498071 [======>.......................] - ETA: 6s 46563328/170498071 [=======>......................] - ETA: 6s 49676288/170498071 [=======>......................] - ETA: 6s 52789248/170498071 [========>.....................] - ETA: 5s 55877632/170498071 [========>.....................] - ETA: 5s 58990592/170498071 [=========>....................] - ETA: 5s 62087168/170498071 [=========>....................] - ETA: 5s 63651840/170498071 [==========>...................] - ETA: 4s 65191936/170498071 [==========>...................] - ETA: 4s 68247552/170498071 [===========>..................] - ETA: 4s 71327744/170498071 [===========>..................] - ETA: 4s 72679424/170498071 [===========>..................] - ETA: 4s 74407936/170498071 [============>.................] - ETA: 4s 75137024/170498071 [============>.................] - ETA: 4s 77520896/170498071 [============>.................] - ETA: 4s 77864960/170498071 [============>.................] - ETA: 4s 80617472/170498071 [=============>................] - ETA: 3s 80683008/170498071 [=============>................] - ETA: 4s 83697664/170498071 [=============>................] - ETA: 3s 86802432/170498071 [==============>...............] - ETA: 3s 89923584/170498071 [==============>...............] - ETA: 3s 92962816/170498071 [===============>..............] - ETA: 3s 96043008/170498071 [===============>..............] - ETA: 3s 99131392/170498071 [================>.............] - ETA: 3s102187008/170498071 [================>.............] - ETA: 2s105291776/170498071 [=================>............] - ETA: 2s108388352/170498071 [==================>...........] - ETA: 2s111443968/170498071 [==================>...........] - ETA: 2s114548736/170498071 [===================>..........] - ETA: 2s117653504/170498071 [===================>..........] - ETA: 2s120741888/170498071 [====================>.........] - ETA: 2s121643008/170498071 [====================>.........] - ETA: 2s123846656/170498071 [====================>.........] - ETA: 1s124329984/170498071 [====================>.........] - ETA: 1s126951424/170498071 [=====================>........] - ETA: 1s127057920/170498071 [=====================>........] - ETA: 1s130056192/170498071 [=====================>........] - ETA: 1s130121728/170498071 [=====================>........] - ETA: 1s133144576/170498071 [======================>.......] - ETA: 1s133259264/170498071 [======================>.......] - ETA: 1s136249344/170498071 [======================>.......] - ETA: 1s136364032/170498071 [======================>.......] - ETA: 1s139362304/170498071 [=======================>......] - ETA: 1s139493376/170498071 [=======================>......] - ETA: 1s142548992/170498071 [========================>.....] - ETA: 1s144203776/170498071 [========================>.....] - ETA: 1s145637376/170498071 [========================>.....] - ETA: 1s147300352/170498071 [========================>.....] - ETA: 0s148717568/170498071 [=========================>....] - ETA: 0s149913600/170498071 [=========================>....] - ETA: 0s151814144/170498071 [=========================>....] - ETA: 0s152625152/170498071 [=========================>....] - ETA: 0s154902528/170498071 [==========================>...] - ETA: 0s155312128/170498071 [==========================>...] - ETA: 0s158023680/170498071 [==========================>...] - ETA: 0s158277632/170498071 [==========================>...] - ETA: 0s161095680/170498071 [===========================>..] - ETA: 0s161415168/170498071 [===========================>..] - ETA: 0s164192256/170498071 [===========================>..] - ETA: 0s164519936/170498071 [===========================>..] - ETA: 0s167280640/170498071 [============================>.] - ETA: 0s167624704/170498071 [============================>.] - ETA: 0s170369024/170498071 [============================>.] - ETA: 0s170498071/170498071 [==============================] - 7s 0us/step
====================================================================================================================================================================================================
[experiment: 1/6, params: ('CIFAR-10 (AIRPLANE)', 16, 8)]
[description: {'T': 16, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}]
====================================================================================================================================================================================================
[clf: AdaBoostClassifier(n_estimators=16)]
[fit...]
[fit done; time: 95.27462840080261 s]
[predict train...]
[predict train done; time: 2.1506500244140625 s, acc: 0.90676]
[predict test...]
[predict test done; time: 0.4323434829711914 s, acc: 0.9062]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: GradientBoostingClassifier(max_depth=1, n_estimators=16)]
[fit...]
[fit done; time: 89.45223236083984 s]
[predict train...]
[predict train done; time: 0.21518325805664062 s, acc: 0.9]
[predict test...]
[predict test done; time: 0.04364752769470215 s, acc: 0.9]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=16)]
[fit...]
[fit done; time: 103.96224355697632 s]
[predict train...]
[predict train done; time: 0.6834461688995361 s, acc: 0.9]
[predict test...]
[predict test done; time: 0.5744104385375977 s, acc: 0.9]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=16, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[fit...]
[fit done; time: 48.903475284576416 s]
[predict train...]
[predict train done; time: 0.0066983699798583984 s, acc: 0.90766]
[predict test...]
[predict test done; time: 0.00127410888671875 s, acc: 0.9054]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=16, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 7.843409776687622 s]
[predict train...]
[predict train done; time: 0.007923126220703125 s, acc: 0.9075]
[predict test...]
[predict test done; time: 0.0022678375244140625 s, acc: 0.906]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 1/6 ({'T': 16, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}):]
[0: AdaBoostClassifier(n_estimators=16)]
[0: {'time_fit': [95.27462840080261, 1.0911849807445748], 'time_predict_train': [2.1506500244140625, 1.0], 'time_predict_test': [0.4323434829711914, 1.3285974258015418], 'acc_train': [0.90676, 1.0009925448850854], 'acc_test': [0.9062, 1.0]}]
[1: GradientBoostingClassifier(max_depth=1, n_estimators=16)]
[1: {'time_fit': [89.45223236083984, 1.1622096040890828], 'time_predict_train': [0.21518325805664062, 9.994504423053058], 'time_predict_test': [0.04364752769470215, 13.160205603290526], 'acc_train': [0.9, 1.0085111111111111], 'acc_test': [0.9, 1.006888888888889]}]
[2: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=16)]
[2: {'time_fit': [103.96224355697632, 1.0], 'time_predict_train': [0.6834461688995361, 3.146773107056804], 'time_predict_test': [0.5744104385375977, 1.0], 'acc_train': [0.9, 1.0085111111111111], 'acc_test': [0.9, 1.006888888888889]}]
[3: FastRealBoostBins(T=16, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[3: {'time_fit': [48.903475284576416, 2.1258661670158396], 'time_predict_train': [0.0066983699798583984, 321.07065314112833], 'time_predict_test': [0.00127410888671875, 450.8330838323353], 'acc_train': [0.90766, 1.0], 'acc_test': [0.9054, 1.0008835873647006]}]
[4: FastRealBoostBins(T=16, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[4: {'time_fit': [7.843409776687622, 13.254725497828188], 'time_predict_train': [0.007923126220703125, 271.43957631198845], 'time_predict_test': [0.0022678375244140625, 253.28553406223716], 'acc_train': [0.9075, 1.0001763085399449], 'acc_test': [0.906, 1.0002207505518763]}]
====================================================================================================================================================================================================
[experiment: 2/6, params: ('CIFAR-10 (AIRPLANE)', 32, 8)]
[description: {'T': 32, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}]
====================================================================================================================================================================================================
[clf: AdaBoostClassifier(n_estimators=32)]
[fit...]
[fit done; time: 190.54094862937927 s]
[predict train...]
[predict train done; time: 4.330488443374634 s, acc: 0.9083]
[predict test...]
[predict test done; time: 0.8706479072570801 s, acc: 0.9056]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: GradientBoostingClassifier(max_depth=1, n_estimators=32)]
[fit...]
[fit done; time: 178.66934609413147 s]
[predict train...]
[predict train done; time: 0.22793340682983398 s, acc: 0.9]
[predict test...]
[predict test done; time: 0.045265913009643555 s, acc: 0.9]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=32)]
[fit...]
[fit done; time: 107.79295587539673 s]
[predict train...]
[predict train done; time: 1.261538028717041 s, acc: 0.9]
[predict test...]
[predict test done; time: 1.179779052734375 s, acc: 0.9]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=32, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[fit...]
[fit done; time: 91.90302062034607 s]
[predict train...]
[predict train done; time: 0.013407230377197266 s, acc: 0.9081]
[predict test...]
[predict test done; time: 0.002270221710205078 s, acc: 0.9038]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=32, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 10.277857542037964 s]
[predict train...]
[predict train done; time: 0.013060569763183594 s, acc: 0.90856]
[predict test...]
[predict test done; time: 0.0031065940856933594 s, acc: 0.9045]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 2/6 ({'T': 32, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}):]
[0: AdaBoostClassifier(n_estimators=32)]
[0: {'time_fit': [190.54094862937927, 1.0], 'time_predict_train': [4.330488443374634, 1.0], 'time_predict_test': [0.8706479072570801, 1.355058736029347], 'acc_train': [0.9083, 1.000286249036662], 'acc_test': [0.9056, 1.0]}]
[1: GradientBoostingClassifier(max_depth=1, n_estimators=32)]
[1: {'time_fit': [178.66934609413147, 1.0664445401226983], 'time_predict_train': [0.22793340682983398, 18.998919480932447], 'time_predict_test': [0.045265913009643555, 26.063299606550125], 'acc_train': [0.9, 1.009511111111111], 'acc_test': [0.9, 1.0062222222222221]}]
[2: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=32)]
[2: {'time_fit': [107.79295587539673, 1.7676567738770899], 'time_predict_train': [1.261538028717041, 3.4327054316219496], 'time_predict_test': [1.179779052734375, 1.0], 'acc_train': [0.9, 1.009511111111111], 'acc_test': [0.9, 1.0062222222222221]}]
[3: FastRealBoostBins(T=32, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[3: {'time_fit': [91.90302062034607, 2.073282764192368], 'time_predict_train': [0.013407230377197266, 322.9964967813067], 'time_predict_test': [0.002270221710205078, 519.6756983826928], 'acc_train': [0.9081, 1.0005065521418346], 'acc_test': [0.9038, 1.0019915910599688]}]
[4: FastRealBoostBins(T=32, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[4: {'time_fit': [10.277857542037964, 18.538975447950946], 'time_predict_train': [0.013060569763183594, 331.5696422051844], 'time_predict_test': [0.0031065940856933594, 379.76607828089027], 'acc_train': [0.90856, 1.0], 'acc_test': [0.9045, 1.001216141514649]}]
====================================================================================================================================================================================================
[experiment: 3/6, params: ('CIFAR-10 (AIRPLANE)', 64, 8)]
[description: {'T': 64, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}]
====================================================================================================================================================================================================
[clf: AdaBoostClassifier(n_estimators=64)]
[fit...]
[fit done; time: 381.00813007354736 s]
[predict train...]
[predict train done; time: 8.606465101242065 s, acc: 0.90972]
[predict test...]
[predict test done; time: 1.7565507888793945 s, acc: 0.9051]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: GradientBoostingClassifier(max_depth=1, n_estimators=64)]
[fit...]
[fit done; time: 357.41058135032654 s]
[predict train...]
[predict train done; time: 0.2448568344116211 s, acc: 0.90474]
[predict test...]
[predict test done; time: 0.04942941665649414 s, acc: 0.9048]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=64)]
[fit...]
[fit done; time: 117.68365859985352 s]
[predict train...]
[predict train done; time: 2.535264730453491 s, acc: 0.9016]
[predict test...]
[predict test done; time: 2.399632453918457 s, acc: 0.9014]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=64, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[fit...]
[fit done; time: 179.8267571926117 s]
[predict train...]
[predict train done; time: 0.025765657424926758 s, acc: 0.90854]
[predict test...]
[predict test done; time: 0.004439592361450195 s, acc: 0.9039]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=64, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 15.192973852157593 s]
[predict train...]
[predict train done; time: 0.024205684661865234 s, acc: 0.90968]
[predict test...]
[predict test done; time: 0.005039691925048828 s, acc: 0.9062]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 3/6 ({'T': 64, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}):]
[0: AdaBoostClassifier(n_estimators=64)]
[0: {'time_fit': [381.00813007354736, 1.0], 'time_predict_train': [8.606465101242065, 1.0], 'time_predict_test': [1.7565507888793945, 1.3661047941854967], 'acc_train': [0.90972, 1.0], 'acc_test': [0.9051, 1.0012153353220639]}]
[1: GradientBoostingClassifier(max_depth=1, n_estimators=64)]
[1: {'time_fit': [357.41058135032654, 1.0660236432678276], 'time_predict_train': [0.2448568344116211, 35.148968261077854], 'time_predict_test': [0.04942941665649414, 48.54664724438313], 'acc_train': [0.90474, 1.005504343789376], 'acc_test': [0.9048, 1.0015473032714413]}]
[2: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=64)]
[2: {'time_fit': [117.68365859985352, 3.23756190627151], 'time_predict_train': [2.535264730453491, 3.394700757621709], 'time_predict_test': [2.399632453918457, 1.0], 'acc_train': [0.9016, 1.0090062111801243], 'acc_test': [0.9014, 1.005325049922343]}]
[3: FastRealBoostBins(T=64, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[3: {'time_fit': [179.8267571926117, 2.118751046961555], 'time_predict_train': [0.025765657424926758, 334.0285465767241], 'time_predict_test': [0.004439592361450195, 540.5073841361904], 'acc_train': [0.90854, 1.0012987870649612], 'acc_test': [0.9039, 1.0025445292620865]}]
[4: FastRealBoostBins(T=64, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[4: {'time_fit': [15.192973852157593, 25.077916527806003], 'time_predict_train': [0.024205684661865234, 355.55553257293695], 'time_predict_test': [0.005039691925048828, 476.14665531270697], 'acc_train': [0.90968, 1.0000439715064637], 'acc_test': [0.9062, 1.0]}]
====================================================================================================================================================================================================
[experiment: 4/6, params: ('CIFAR-10 (AIRPLANE)', 128, 8)]
[description: {'T': 128, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}]
====================================================================================================================================================================================================
[clf: AdaBoostClassifier(n_estimators=128)]
[fit...]
[fit done; time: 762.3241939544678 s]
[predict train...]
[predict train done; time: 17.175698041915894 s, acc: 0.91046]
[predict test...]
[predict test done; time: 3.498439311981201 s, acc: 0.9052]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: GradientBoostingClassifier(max_depth=1, n_estimators=128)]
[fit...]
[fit done; time: 714.8022072315216 s]
[predict train...]
[predict train done; time: 0.2810859680175781 s, acc: 0.90952]
[predict test...]
[predict test done; time: 0.05679512023925781 s, acc: 0.909]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=128)]
[fit...]
[fit done; time: 136.25107169151306 s]
[predict train...]
[predict train done; time: 5.059379577636719 s, acc: 0.90698]
[predict test...]
[predict test done; time: 4.832674026489258 s, acc: 0.9068]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=128, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[fit...]
[fit done; time: 356.52304792404175 s]
[predict train...]
[predict train done; time: 0.0526273250579834 s, acc: 0.90932]
[predict test...]
[predict test done; time: 0.008054494857788086 s, acc: 0.9032]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=128, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 25.03038191795349 s]
[predict train...]
[predict train done; time: 0.0445866584777832 s, acc: 0.91022]
[predict test...]
[predict test done; time: 0.008085250854492188 s, acc: 0.9016]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 4/6 ({'T': 128, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}):]
[0: AdaBoostClassifier(n_estimators=128)]
[0: {'time_fit': [762.3241939544678, 1.0], 'time_predict_train': [17.175698041915894, 1.0], 'time_predict_test': [3.498439311981201, 1.381379979906659], 'acc_train': [0.91046, 1.0], 'acc_test': [0.9052, 1.0041979673000443]}]
[1: GradientBoostingClassifier(max_depth=1, n_estimators=128)]
[1: {'time_fit': [714.8022072315216, 1.066482708422239], 'time_predict_train': [0.2810859680175781, 61.104786421931195], 'time_predict_test': [0.05679512023925781, 85.08959935520704], 'acc_train': [0.90952, 1.00103351218225], 'acc_test': [0.909, 1.0]}]
[2: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=128)]
[2: {'time_fit': [136.25107169151306, 5.594995947484736], 'time_predict_train': [5.059379577636719, 3.3948229774724306], 'time_predict_test': [4.832674026489258, 1.0], 'acc_train': [0.90698, 1.0038369093034025], 'acc_test': [0.9068, 1.0024261138067931]}]
[3: FastRealBoostBins(T=128, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[3: {'time_fit': [356.52304792404175, 2.1382185482630653], 'time_predict_train': [0.0526273250579834, 326.3646408589485], 'time_predict_test': [0.008054494857788086, 599.9971583340733], 'acc_train': [0.90932, 1.001253684071614], 'acc_test': [0.9032, 1.0064216120460585]}]
[4: FastRealBoostBins(T=128, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[4: {'time_fit': [25.03038191795349, 30.455955344719573], 'time_predict_train': [0.0445866584777832, 385.220571092455], 'time_predict_test': [0.008085250854492188, 597.7147912243454], 'acc_train': [0.91022, 1.0002636725187317], 'acc_test': [0.9016, 1.0082076308784385]}]
====================================================================================================================================================================================================
[experiment: 5/6, params: ('CIFAR-10 (AIRPLANE)', 512, 8)]
[description: {'T': 512, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}]
====================================================================================================================================================================================================
[clf: AdaBoostClassifier(n_estimators=512)]
[fit...]
[fit done; time: 3069.267597913742 s]
[predict train...]
[predict train done; time: 70.86479115486145 s, acc: 0.91762]
[predict test...]
[predict test done; time: 14.439393281936646 s, acc: 0.9076]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: GradientBoostingClassifier(max_depth=1, n_estimators=512)]
[fit...]
[fit done; time: 2861.1997339725494 s]
[predict train...]
[predict train done; time: 0.4958207607269287 s, acc: 0.91458]
[predict test...]
[predict test done; time: 0.0984339714050293 s, acc: 0.9131]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=512)]
[fit...]
[fit done; time: 253.28590178489685 s]
[predict train...]
[predict train done; time: 19.8365535736084 s, acc: 0.91298]
[predict test...]
[predict test done; time: 19.16443157196045 s, acc: 0.9116]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=512, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[fit...]
[fit done; time: 1409.6043953895569 s]
[predict train...]
[predict train done; time: 0.21473407745361328 s, acc: 0.91722]
[predict test...]
[predict test done; time: 0.0324709415435791 s, acc: 0.8995]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=512, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 83.98297476768494 s]
[predict train...]
[predict train done; time: 0.17154645919799805 s, acc: 0.91676]
[predict test...]
[predict test done; time: 0.024791955947875977 s, acc: 0.8977]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 5/6 ({'T': 512, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}):]
[0: AdaBoostClassifier(n_estimators=512)]
[0: {'time_fit': [3069.267597913742, 1.0], 'time_predict_train': [70.86479115486145, 1.0], 'time_predict_test': [14.439393281936646, 1.327232467304199], 'acc_train': [0.91762, 1.0], 'acc_test': [0.9076, 1.00605993829881]}]
[1: GradientBoostingClassifier(max_depth=1, n_estimators=512)]
[1: {'time_fit': [2861.1997339725494, 1.072720496046009], 'time_predict_train': [0.4958207607269287, 142.92421126329148], 'time_predict_test': [0.0984339714050293, 194.69326796847372], 'acc_train': [0.91458, 1.0033239301099959], 'acc_test': [0.9131, 1.0]}]
[2: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=512)]
[2: {'time_fit': [253.28590178489685, 12.11779880476853], 'time_predict_train': [19.8365535736084, 3.5724346415268284], 'time_predict_test': [19.16443157196045, 1.0], 'acc_train': [0.91298, 1.0050822580998489], 'acc_test': [0.9116, 1.001645458534445]}]
[3: FastRealBoostBins(T=512, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[3: {'time_fit': [1409.6043953895569, 2.1773964439615145], 'time_predict_train': [0.21473407745361328, 330.01185463993073], 'time_predict_test': [0.0324709415435791, 590.2025214218058], 'acc_train': [0.91722, 1.0004361003903097], 'acc_test': [0.8995, 1.0151195108393554]}]
[4: FastRealBoostBins(T=512, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
[4: {'time_fit': [83.98297476768494, 36.546307229578375], 'time_predict_train': [0.17154645919799805, 413.09387256468915], 'time_predict_test': [0.024791955947875977, 773.0100687599173], 'acc_train': [0.91676, 1.0009380863039399], 'acc_test': [0.8977, 1.0171549515428318]}]
====================================================================================================================================================================================================
[experiment: 6/6, params: ('CIFAR-10 (AIRPLANE)', 1024, 8)]
[description: {'T': 1024, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}]
====================================================================================================================================================================================================
[clf: AdaBoostClassifier(n_estimators=1024)]
[fit...]
[fit done; time: 6107.316838026047 s]
[predict train...]
[predict train done; time: 138.90537214279175 s, acc: 0.92572]
[predict test...]
[predict test done; time: 28.297104358673096 s, acc: 0.9045]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: GradientBoostingClassifier(max_depth=1, n_estimators=1024)]
[fit...]
[fit done; time: 5729.919969320297 s]
[predict train...]
[predict train done; time: 0.7726938724517822 s, acc: 0.9169]
[predict test...]
[predict test done; time: 0.1535789966583252 s, acc: 0.9125]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=1024)]
[fit...]
[fit done; time: 407.923770904541 s]
[predict train...]
[predict train done; time: 39.30928707122803 s, acc: 0.91518]
[predict test...]
[predict test done; time: 39.38657903671265 s, acc: 0.9119]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=1024, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[fit...]
[fit done; time: 2806.5561809539795 s]
[predict train...]
[predict train done; time: 0.43863987922668457 s, acc: 0.9243]
[predict test...]
[predict test done; time: 0.06718587875366211 s, acc: 0.8949]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=1024, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 162.90295124053955 s]
[predict train...]
[predict train done; time: 0.34522342681884766 s, acc: 0.92408]
[predict test...]
[predict test done; time: 0.05241799354553223 s, acc: 0.8947]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 6/6 ({'T': 1024, 'B': 8, 'data_name': 'CIFAR-10 (AIRPLANE)', 'n': 3072, 'm_train': 50000, 'm_test': 10000}):]
[0: AdaBoostClassifier(n_estimators=1024)]
[0: {'time_fit': [6107.316838026047, 1.0], 'time_predict_train': [138.90537214279175, 1.0], 'time_predict_test': [28.297104358673096, 1.3918943273303728], 'acc_train': [0.92572, 1.0], 'acc_test': [0.9045, 1.0088446655610834]}]
[1: GradientBoostingClassifier(max_depth=1, n_estimators=1024)]
[1: {'time_fit': [5729.919969320297, 1.0658642477951603], 'time_predict_train': [0.7726938724517822, 179.76766361824585], 'time_predict_test': [0.1535789966583252, 256.45810881508703], 'acc_train': [0.9169, 1.009619369615007], 'acc_test': [0.9125, 1.0]}]
[2: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=1024)]
[2: {'time_fit': [407.923770904541, 14.971711073575143], 'time_predict_train': [39.30928707122803, 3.533652795358426], 'time_predict_test': [39.38657903671265, 1.0], 'acc_train': [0.91518, 1.0115168600712428], 'acc_test': [0.9119, 1.0006579668823334]}]
[3: FastRealBoostBins(T=1024, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_jit', decision_function_mode='numba_jit')]
[3: {'time_fit': [2806.5561809539795, 2.1760892867464716], 'time_predict_train': [0.43863987922668457, 316.67292173178555], 'time_predict_test': [0.06718587875366211, 586.2329966855691], 'acc_train': [0.9243, 1.0015362977388294], 'acc_test': [0.8949, 1.0196670018996534]}]
[4: FastRealBoostBins(T=1024, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[4: {'time_fit': [162.90295124053955, 37.49052298633984], 'time_predict_train': [0.34522342681884766, 402.3636907343512], 'time_predict_test': [0.05241799354553223, 751.3942517181623], 'acc_train': [0.92408, 1.0017747381179118], 'acc_test': [0.8947, 1.0198949368503407]}]
[about to generate wanted plots]
EXPERIMENT REAL DATA DONE. [time: 27304.795432329178 s, hash string: real_0822149182_20230621]
MAIN (EXPERIMENTER) DONE.
