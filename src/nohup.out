2023-06-24 00:51:24.066556: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-24 00:51:24.601564: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
DEMONSTRATION OF "FAST REAL BOOST WITH BINS": AN ENSEMBLE CLASSIFIER FOR FAST PREDICTIONS IMPLEMENTED IN PYTHON VIA NUMBA.JIT AND NUMBA.CUDA.
MAIN-EXPERIMENTER STARTING...]
CPU AND SYSTEM PROPS: {'cpu_name': 'Intel(R) Core(TM) i7-10700 CPU @ 2.90GHz', 'ram_size': '125.7 GB', 'os_name': 'Linux 5.15.0-71-generic', 'os_version': '#78~20.04.1-Ubuntu SMP Wed Apr 19 11:26:48 UTC 2023', 'os_machine': 'x86_64'}
GPU PROPS: {'name': 'NVIDIA GeForce RTX 3090', 'max_threads_per_block': 1024, 'max_block_dim_x': 1024, 'max_block_dim_y': 1024, 'max_block_dim_z': 64, 'max_grid_dim_x': 2147483647, 'max_grid_dim_y': 65535, 'max_grid_dim_z': 65535, 'max_shared_memory_per_block': 49152, 'async_engine_count': 2, 'can_map_host_memory': 1, 'multiprocessor_count': 82, 'warp_size': 32, 'unified_addressing': 1, 'pci_bus_id': 1, 'pci_device_id': 0, 'compute_capability': (8, 6), 'cores_per_SM': 128, 'cores_total': 10496}
[data kind: real, real data flags: [False, False, False, False, False, True, False], clfs flags: [False, False, True, False, True], seed: 0]
EXPERIMENTER REAL DATA...
[experiment hash string: real_2371475359_20230624]
[data definitions:]
[data def 0 (active: False): (name short: 'fddb-patches', reading function: read_data_fddb_patches(), name full: 'FDDB-PATCHES (3NPI))']
[data def 1 (active: False): (name short: 'cifar-10', reading function: read_data_cifar_10(), name full: 'CIFAR-10 (AIRPLANE))']
[data def 2 (active: False): (name short: 'mnist-b', reading function: read_data_mnist_b(), name full: 'MNIST-B (DIGIT 0))']
[data def 3 (active: False): (name short: 'fddb-hfs-100', reading function: read_data_fddb_haar_npi_100(), name full: 'FDDB-HFs (100NPI))']
[data def 4 (active: False): (name short: 'fddb-hfs-300', reading function: read_data_fddb_haar_npi_300(), name full: 'FDDB-HFs (300NPI))']
[data def 5 (active: True): (name short: 'hagrid-hfs-10', reading function: read_data_hagrid_haar_npi_10(), name full: 'HaGRID-HFs (PALM, 10NPI))']
[data def 6 (active: False): (name short: 'hagrid-hfs-30', reading function: read_data_hagrid_haar_npi_30(), name full: 'HaGRID-HFs (PALM, 30NPI))']
[clfs definitions:]
[clf def 0 (active: False): AdaBoostClassifier({'algorithm': 'SAMME.R'})]
[clf def 1 (active: False): GradientBoostingClassifier({'max_depth': 1})]
[clf def 2 (active: True): HistGradientBoostingClassifier({'max_depth': 1, 'early_stopping': False})]
[clf def 3 (active: False): FastRealBoostBins({'fit_mode': 'numba_jit', 'decision_function_mode': 'numba_jit'})]
[clf def 4 (active: True): FastRealBoostBins({'fit_mode': 'numba_cuda', 'decision_function_mode': 'numba_cuda'})]
[other settings -> Ts: [16, 32, 64, 128, 256, 512, 1024], Bs: [8], seed: 0]
UNPICKLE OBJECTS... [from file: ../data/data_hand_n_18225_S_5_P_5_NPI_10_SEED_0.bin]
UNPICKLE OBJECTS DONE. [time: 25.767709016799927 s]
====================================================================================================================================================================================================
[experiment: 1/7, params: ('HaGRID-HFs (PALM, 10NPI)', 16, 8)]
[description: {'T': 16, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=16)]
[fit...]
[fit done; time: 274.2819592952728 s]
[predict train...]
[predict train done; time: 3.3558778762817383 s, acc: 0.9144722964799676]
[predict test...]
[predict test done; time: 1.1279795169830322 s, acc: 0.9147133651027339]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=16, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 219.0769760608673 s]
[predict train...]
[predict train done; time: 0.06030607223510742 s, acc: 0.9651655840102626]
[predict test...]
[predict test done; time: 0.015544891357421875 s, acc: 0.9658672658943861]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 1/7 ({'T': 16, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=16)]
[0: {'time_fit': [274.2819592952728, 1.0], 'time_predict_train': [3.3558778762817383, 1.0], 'time_predict_test': [1.1279795169830322, 1.0], 'acc_train': [0.9144722964799676, 1.0554344704868874], 'acc_test': [0.9147133651027339, 1.0559234211975321]}]
[1: FastRealBoostBins(T=16, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [219.0769760608673, 1.2519889776964406], 'time_predict_train': [0.06030607223510742, 55.647429054882146], 'time_predict_test': [0.015544891357421875, 72.56271472392638], 'acc_train': [0.9651655840102626, 1.0], 'acc_test': [0.9658672658943861, 1.0]}]
====================================================================================================================================================================================================
[experiment: 2/7, params: ('HaGRID-HFs (PALM, 10NPI)', 32, 8)]
[description: {'T': 32, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=32)]
[fit...]
[fit done; time: 293.9111442565918 s]
[predict train...]
[predict train done; time: 3.4250645637512207 s, acc: 0.9144722964799676]
[predict test...]
[predict test done; time: 1.1370115280151367 s, acc: 0.9147133651027339]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=32, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 287.52966499328613 s]
[predict train...]
[predict train done; time: 0.10406160354614258 s, acc: 0.9763967989530734]
[predict test...]
[predict test done; time: 0.027095317840576172 s, acc: 0.9766636963568505]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 2/7 ({'T': 32, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=32)]
[0: {'time_fit': [293.9111442565918, 1.0], 'time_predict_train': [3.4250645637512207, 1.0], 'time_predict_test': [1.1370115280151367, 1.0], 'acc_train': [0.9144722964799676, 1.0677161054648332], 'acc_test': [0.9147133651027339, 1.06772649620918]}]
[1: FastRealBoostBins(T=32, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [287.52966499328613, 1.022194159560735], 'time_predict_train': [0.10406160354614258, 32.913816883789345], 'time_predict_test': [0.027095317840576172, 41.96339510409517], 'acc_train': [0.9763967989530734, 1.0], 'acc_test': [0.9766636963568505, 1.0]}]
====================================================================================================================================================================================================
[experiment: 3/7, params: ('HaGRID-HFs (PALM, 10NPI)', 64, 8)]
[description: {'T': 64, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=64)]
[fit...]
[fit done; time: 331.73696541786194 s]
[predict train...]
[predict train done; time: 3.5807299613952637 s, acc: 0.9196940150409602]
[predict test...]
[predict test done; time: 1.1878166198730469 s, acc: 0.9202278098485142]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=64, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 424.367103099823 s]
[predict train...]
[predict train done; time: 0.1996324062347412 s, acc: 0.9822168842741467]
[predict test...]
[predict test done; time: 0.04832911491394043 s, acc: 0.9822168842741467]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 3/7 ({'T': 64, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=64)]
[0: {'time_fit': [331.73696541786194, 1.2792276632942683], 'time_predict_train': [3.5807299613952637, 1.0], 'time_predict_test': [1.1878166198730469, 1.0], 'acc_train': [0.9196940150409602, 1.0679822508472037], 'acc_test': [0.9202278098485142, 1.0673627484001347]}]
[1: FastRealBoostBins(T=64, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [424.367103099823, 1.0], 'time_predict_train': [0.1996324062347412, 17.936616749410916], 'time_predict_test': [0.04832911491394043, 24.577661353579305], 'acc_train': [0.9822168842741467, 1.0], 'acc_test': [0.9822168842741467, 1.0]}]
====================================================================================================================================================================================================
[experiment: 4/7, params: ('HaGRID-HFs (PALM, 10NPI)', 128, 8)]
[description: {'T': 128, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=128)]
[fit...]
[fit done; time: 407.2960968017578 s]
[predict train...]
[predict train done; time: 3.9999465942382812 s, acc: 0.9402149815539456]
[predict test...]
[predict test done; time: 1.316457986831665 s, acc: 0.9401676287887594]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=128, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 697.9872930049896 s]
[predict train...]
[predict train done; time: 0.37807536125183105 s, acc: 0.9860998110194189]
[predict test...]
[predict test done; time: 0.09521365165710449 s, acc: 0.9859620575206953]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 4/7 ({'T': 128, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=128)]
[0: {'time_fit': [407.2960968017578, 1.7137097519123028], 'time_predict_train': [3.9999465942382812, 1.0], 'time_predict_test': [1.316457986831665, 1.0], 'acc_train': [0.9402149815539456, 1.0488024870542234], 'acc_test': [0.9401676287887594, 1.0487087912087911]}]
[1: FastRealBoostBins(T=128, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [697.9872930049896, 1.0], 'time_predict_train': [0.37807536125183105, 10.579760027191957], 'time_predict_test': [0.09521365165710449, 13.826357501471122], 'acc_train': [0.9860998110194189, 1.0], 'acc_test': [0.9859620575206953, 1.0]}]
====================================================================================================================================================================================================
[experiment: 5/7, params: ('HaGRID-HFs (PALM, 10NPI)', 256, 8)]
[description: {'T': 256, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=256)]
[fit...]
[fit done; time: 555.0028092861176 s]
[predict train...]
[predict train done; time: 4.538906812667847 s, acc: 0.9600471805733128]
[predict test...]
[predict test done; time: 1.4861323833465576 s, acc: 0.9604561362726486]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=256, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 1244.8278682231903 s]
[predict train...]
[predict train done; time: 0.7526702880859375 s, acc: 0.9892078743343707]
[predict test...]
[predict test done; time: 0.1911771297454834 s, acc: 0.9876538426768948]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 5/7 ({'T': 256, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=256)]
[0: {'time_fit': [555.0028092861176, 2.2429217427284245], 'time_predict_train': [4.538906812667847, 1.0], 'time_predict_test': [1.4861323833465576, 1.0], 'acc_train': [0.9600471805733128, 1.0303742298827896], 'acc_test': [0.9604561362726486, 1.0283174893439646]}]
[1: FastRealBoostBins(T=256, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [1244.8278682231903, 1.0], 'time_predict_train': [0.7526702880859375, 6.03040519137592], 'time_predict_test': [0.1911771297454834, 7.773588741106559], 'acc_train': [0.9892078743343707, 1.0], 'acc_test': [0.9876538426768948, 1.0]}]
====================================================================================================================================================================================================
[experiment: 6/7, params: ('HaGRID-HFs (PALM, 10NPI)', 512, 8)]
[description: {'T': 512, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=512)]
[fit...]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
[fit done; time: 857.0508816242218 s]
[predict train...]
[predict train done; time: 5.92792820930481 s, acc: 0.9743003628943732]
[predict test...]
[predict test done; time: 1.9355127811431885 s, acc: 0.9746361370475121]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=512, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 2338.6894192695618 s]
[predict train...]
[predict train done; time: 1.4317426681518555 s, acc: 0.9930004003461057]
[predict test...]
[predict test done; time: 0.3702201843261719 s, acc: 0.9889581961179342]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 6/7 ({'T': 512, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=512)]
[0: {'time_fit': [857.0508816242218, 2.7287637985243585], 'time_predict_train': [5.92792820930481, 1.0], 'time_predict_test': [1.9355127811431885, 1.0], 'acc_train': [0.9743003628943732, 1.0191932982516603], 'acc_test': [0.9746361370475121, 1.0146947753382183]}]
[1: FastRealBoostBins(T=512, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [2338.6894192695618, 1.0], 'time_predict_train': [1.4317426681518555, 4.1403586979473], 'time_predict_test': [0.3702201843261719, 5.228004477027542], 'acc_train': [0.9930004003461057, 1.0], 'acc_test': [0.9889581961179342, 1.0]}]
====================================================================================================================================================================================================
[experiment: 7/7, params: ('HaGRID-HFs (PALM, 10NPI)', 1024, 8)]
[description: {'T': 1024, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=1024)]
[fit...]
[fit done; time: 1457.8239150047302 s]
[predict train...]
[predict train done; time: 8.445616483688354 s, acc: 0.98215231232162]
[predict test...]
[predict test done; time: 2.7716453075408936 s, acc: 0.9825268296462748]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=1024, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 4530.413292884827 s]
[predict train...]
[predict train done; time: 2.846062660217285 s, acc: 0.9981919853292524]
[predict test...]
[predict test done; time: 0.7337255477905273 s, acc: 0.9899009466248241]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 7/7 ({'T': 1024, 'B': 8, 'data_name': 'HaGRID-HFs (PALM, 10NPI)', 'n': 18225, 'm_train': 232299, 'm_test': 77433}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=1024)]
[0: {'time_fit': [1457.8239150047302, 3.1076546668327407], 'time_predict_train': [8.445616483688354, 1.0], 'time_predict_test': [2.7716453075408936, 1.0], 'acc_train': [0.98215231232162, 1.0163311462045206], 'acc_test': [0.9825268296462748, 1.0075052576235541]}]
[1: FastRealBoostBins(T=1024, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [4530.413292884827, 1.0], 'time_predict_train': [2.846062660217285, 2.967473837362234], 'time_predict_test': [0.7337255477905273, 3.77749598046186], 'acc_train': [0.9981919853292524, 1.0], 'acc_test': [0.9899009466248241, 1.0]}]
[about to generate wanted plots]
EXPERIMENT REAL DATA DONE. [time: 13997.275614500046 s, hash string: real_2371475359_20230624]
MAIN-EXPERIMENTER DONE.
