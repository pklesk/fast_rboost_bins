DEMONSTRATION OF "FAST REAL BOOST WITH BINS": AN ENSEMBLE CLASSIFIER FOR FAST PREDICTIONS IMPLEMENTED IN PYTHON VIA NUMBA.JIT AND NUMBA.CUDA.
MAIN-EXPERIMENTER STARTING...]
CPU AND SYSTEM PROPS: {'cpu_name': 'Intel(R) Core(TM) i7-10700 CPU @ 2.90GHz', 'ram_size': '125.7 GB', 'os_name': 'Linux 5.15.0-71-generic', 'os_version': '#78~20.04.1-Ubuntu SMP Wed Apr 19 11:26:48 UTC 2023', 'os_machine': 'x86_64'}
GPU PROPS: {'name': 'NVIDIA GeForce RTX 3090', 'max_threads_per_block': 1024, 'max_block_dim_x': 1024, 'max_block_dim_y': 1024, 'max_block_dim_z': 64, 'max_grid_dim_x': 2147483647, 'max_grid_dim_y': 65535, 'max_grid_dim_z': 65535, 'max_shared_memory_per_block': 49152, 'async_engine_count': 2, 'can_map_host_memory': 1, 'multiprocessor_count': 82, 'warp_size': 32, 'unified_addressing': 1, 'pci_bus_id': 1, 'pci_device_id': 0, 'compute_capability': (8, 6), 'cores_per_SM': 128, 'cores_total': 10496}
[data kind: real, real data flags: [False, False, False, True, False, False, False], clfs flags: [False, False, True, False, True], seed: 0]
EXPERIMENTER REAL DATA...
[experiment hash string: real_0790809631_20230624]
[data definitions:]
[data def 0 (active: False): (name short: 'fddb-patches', reading function: read_data_fddb_patches(), name full: 'FDDB-PATCHES (3NPI))']
[data def 1 (active: False): (name short: 'cifar-10', reading function: read_data_cifar_10(), name full: 'CIFAR-10 (AIRPLANE))']
[data def 2 (active: False): (name short: 'mnist-b', reading function: read_data_mnist_b(), name full: 'MNIST-B (DIGIT 0))']
[data def 3 (active: True): (name short: 'fddb-hfs-100', reading function: read_data_fddb_haar_npi_100(), name full: 'FDDB-HFs (100NPI))']
[data def 4 (active: False): (name short: 'fddb-hfs-300', reading function: read_data_fddb_haar_npi_300(), name full: 'FDDB-HFs (300NPI))']
[data def 5 (active: False): (name short: 'hagrid-hfs-10', reading function: read_data_hagrid_haar_npi_10(), name full: 'HaGRID-HFs (PALM, 10NPI))']
[data def 6 (active: False): (name short: 'hagrid-hfs-30', reading function: read_data_hagrid_haar_npi_30(), name full: 'HaGRID-HFs (PALM, 30NPI))']
[clfs definitions:]
[clf def 0 (active: False): AdaBoostClassifier({'algorithm': 'SAMME.R'})]
[clf def 1 (active: False): GradientBoostingClassifier({'max_depth': 1})]
[clf def 2 (active: True): HistGradientBoostingClassifier({'max_depth': 1, 'early_stopping': False})]
[clf def 3 (active: False): FastRealBoostBins({'fit_mode': 'numba_jit', 'decision_function_mode': 'numba_jit'})]
[clf def 4 (active: True): FastRealBoostBins({'fit_mode': 'numba_cuda', 'decision_function_mode': 'numba_cuda'})]
[other settings -> Ts: [16, 32, 64, 128, 256, 512, 1024], Bs: [8], seed: 0]
UNPICKLE OBJECTS... [from file: ../data/data_face_n_18225_S_5_P_5_NPI_100_SEED_0.bin]
UNPICKLE OBJECTS DONE. [time: 53.288567304611206 s]
====================================================================================================================================================================================================
[experiment: 1/7, params: ('FDDB-HFs (100NPI)', 16, 8)]
[description: {'T': 16, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=16)]
[fit...]
[fit done; time: 303.0265212059021 s]
[predict train...]
[predict train done; time: 3.775313377380371 s, acc: 0.9843426203085425]
[predict test...]
[predict test done; time: 0.413348913192749 s, acc: 0.9837332677511155]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=16, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 250.46535277366638 s]
[predict train...]
[predict train done; time: 0.06723141670227051 s, acc: 0.989381379998465]
[predict test...]
[predict test done; time: 0.006540536880493164 s, acc: 0.9897410673505955]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 1/7 ({'T': 16, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=16)]
[0: {'time_fit': [303.0265212059021, 1.0], 'time_predict_train': [3.775313377380371, 1.0], 'time_predict_test': [0.413348913192749, 1.0], 'acc_train': [0.9843426203085425, 1.0051189083820664], 'acc_test': [0.9837332677511155, 1.0061071428571429]}]
[1: FastRealBoostBins(T=16, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [250.46535277366638, 1.2098540490737366], 'time_predict_train': [0.06723141670227051, 56.15400600732653], 'time_predict_test': [0.006540536880493164, 63.19800969635111], 'acc_train': [0.989381379998465, 1.0], 'acc_test': [0.9897410673505955, 1.0]}]
====================================================================================================================================================================================================
[experiment: 2/7, params: ('FDDB-HFs (100NPI)', 32, 8)]
[description: {'T': 32, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=32)]
[fit...]
[fit done; time: 312.4954228401184 s]
[predict train...]
[predict train done; time: 3.8801467418670654 s, acc: 0.9843426203085425]
[predict test...]
[predict test done; time: 0.42429518699645996 s, acc: 0.9837332677511155]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=32, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 327.06547260284424 s]
[predict train...]
[predict train done; time: 0.11740326881408691 s, acc: 0.991100621690076]
[predict test...]
[predict test done; time: 0.010245800018310547 s, acc: 0.9909707339352845]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 2/7 ({'T': 32, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=32)]
[0: {'time_fit': [312.4954228401184, 1.046624842150665], 'time_predict_train': [3.8801467418670654, 1.0], 'time_predict_test': [0.42429518699645996, 1.0], 'acc_train': [0.9843426203085425, 1.0068654970760234], 'acc_test': [0.9837332677511155, 1.0073571428571428]}]
[1: FastRealBoostBins(T=32, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [327.06547260284424, 1.0], 'time_predict_train': [0.11740326881408691, 33.04973346194852], 'time_predict_test': [0.010245800018310547, 41.411620980127516], 'acc_train': [0.991100621690076, 1.0], 'acc_test': [0.9909707339352845, 1.0]}]
====================================================================================================================================================================================================
[experiment: 3/7, params: ('FDDB-HFs (100NPI)', 64, 8)]
[description: {'T': 64, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=64)]
[fit...]
[fit done; time: 351.09780955314636 s]
[predict train...]
[predict train done; time: 4.068461894989014 s, acc: 0.9863458438867142]
[predict test...]
[predict test done; time: 0.44195556640625 s, acc: 0.9857358676176088]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=64, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 479.009330034256 s]
[predict train...]
[predict train done; time: 0.22324681282043457 s, acc: 0.992006293652621]
[predict test...]
[predict test done; time: 0.0182650089263916 s, acc: 0.99177880054808]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 3/7 ({'T': 64, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=64)]
[0: {'time_fit': [351.09780955314636, 1.3643187653147333], 'time_predict_train': [4.068461894989014, 1.0], 'time_predict_test': [0.44195556640625, 1.0], 'acc_train': [0.9863458438867142, 1.0057388083510361], 'acc_test': [0.9857358676176088, 1.0061303774459138]}]
[1: FastRealBoostBins(T=64, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [479.009330034256, 1.0], 'time_predict_train': [0.22324681282043457, 18.224053654290795], 'time_predict_test': [0.0182650089263916, 24.196843712879687], 'acc_train': [0.992006293652621, 1.0], 'acc_test': [0.99177880054808, 1.0]}]
====================================================================================================================================================================================================
[experiment: 4/7, params: ('FDDB-HFs (100NPI)', 128, 8)]
[description: {'T': 128, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=128)]
[fit...]
[fit done; time: 434.01986718177795 s]
[predict train...]
[predict train done; time: 4.458770036697388 s, acc: 0.9889707575408704]
[predict test...]
[predict test done; time: 0.48407888412475586 s, acc: 0.9887222007518532]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=128, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 785.9852101802826 s]
[predict train...]
[predict train done; time: 0.41649413108825684 s, acc: 0.9929196408012895]
[predict test...]
[predict test done; time: 0.03429222106933594 s, acc: 0.9923058005129466]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 4/7 ({'T': 128, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=128)]
[0: {'time_fit': [434.01986718177795, 1.8109429305250975], 'time_predict_train': [4.458770036697388, 1.0], 'time_predict_test': [0.48407888412475586, 1.0], 'acc_train': [0.9889707575408704, 1.0039929221671207], 'acc_test': [0.9887222007518532, 1.0036244758723616]}]
[1: FastRealBoostBins(T=128, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [785.9852101802826, 1.0], 'time_predict_train': [0.41649413108825684, 10.705481071358856], 'time_predict_test': [0.03429222106933594, 14.11628844763335], 'acc_train': [0.9929196408012895, 1.0], 'acc_test': [0.9923058005129466, 1.0]}]
====================================================================================================================================================================================================
[experiment: 5/7, params: ('FDDB-HFs (100NPI)', 256, 8)]
[description: {'T': 256, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=256)]
[fit...]
[fit done; time: 604.327399969101 s]
[predict train...]
[predict train done; time: 5.207545757293701 s, acc: 0.9910046818635352]
[predict test...]
[predict test done; time: 0.5627026557922363 s, acc: 0.9909707339352845]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=256, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 1399.7448711395264 s]
[predict train...]
[predict train done; time: 0.8027639389038086 s, acc: 0.9943894389438944]
[predict test...]
[predict test done; time: 0.06321239471435547 s, acc: 0.9930787337947511]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 5/7 ({'T': 256, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=256)]
[0: {'time_fit': [604.327399969101, 2.3162028913650032], 'time_predict_train': [5.207545757293701, 1.0], 'time_predict_test': [0.5627026557922363, 1.0], 'acc_train': [0.9910046818635352, 1.0034154804132653], 'acc_test': [0.9909707339352845, 1.002127206977239]}]
[1: FastRealBoostBins(T=256, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [1399.7448711395264, 1.0], 'time_predict_train': [0.8027639389038086, 6.487020037801794], 'time_predict_test': [0.06321239471435547, 8.901777227946834], 'acc_train': [0.9943894389438944, 1.0], 'acc_test': [0.9930787337947511, 1.0]}]
====================================================================================================================================================================================================
[experiment: 6/7, params: ('FDDB-HFs (100NPI)', 512, 8)]
[description: {'T': 512, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=512)]
[fit...]
[fit done; time: 935.5620386600494 s]
[predict train...]
[predict train done; time: 6.781143665313721 s, acc: 0.992674034845345]
[predict test...]
[predict test done; time: 0.7282826900482178 s, acc: 0.9925868671608755]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=512, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 2624.4640543460846 s]
[predict train...]
[predict train done; time: 1.5856857299804688 s, acc: 0.9967840970143526]
[predict test...]
[predict test done; time: 0.126190185546875 s, acc: 0.9932895337806977]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 6/7 ({'T': 512, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=512)]
[0: {'time_fit': [935.5620386600494, 2.8052271745708603], 'time_predict_train': [6.781143665313721, 1.0], 'time_predict_test': [0.7282826900482178, 1.0], 'acc_train': [0.992674034845345, 1.0041403945552458], 'acc_test': [0.9925868671608755, 1.0007079144839304]}]
[1: FastRealBoostBins(T=512, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [2624.4640543460846, 1.0], 'time_predict_train': [1.5856857299804688, 4.276473917310995], 'time_predict_test': [0.126190185546875, 5.771310081620315], 'acc_train': [0.9967840970143526, 1.0], 'acc_test': [0.9932895337806977, 1.0]}]
====================================================================================================================================================================================================
[experiment: 7/7, params: ('FDDB-HFs (100NPI)', 1024, 8)]
[description: {'T': 1024, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}]
====================================================================================================================================================================================================
[clf: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=1024)]
[fit...]
[fit done; time: 1607.854210138321 s]
[predict train...]
[predict train done; time: 10.015448808670044 s, acc: 0.9940018420446696]
[predict test...]
[predict test done; time: 1.0524098873138428 s, acc: 0.9935706004286267]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[clf: FastRealBoostBins(T=1024, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[fit...]
[fit done; time: 5076.955407381058 s]
[predict train...]
[predict train done; time: 3.2569236755371094 s, acc: 0.9998234707191649]
[predict test...]
[predict test done; time: 0.25902295112609863 s, acc: 0.9936760004216]
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[results summary for experiment 7/7 ({'T': 1024, 'B': 8, 'data_name': 'FDDB-HFs (100NPI)', 'n': 18225, 'm_train': 260580, 'm_test': 28463}):]
[0: HistGradientBoostingClassifier(early_stopping=False, max_bins=8, max_depth=1, max_iter=1024)]
[0: {'time_fit': [1607.854210138321, 3.1575968613126286], 'time_predict_train': [10.015448808670044, 1.0], 'time_predict_test': [1.0524098873138428, 1.0], 'acc_train': [0.9940018420446696, 1.0058567584367049], 'acc_test': [0.9935706004286267, 1.000106082036775]}]
[1: FastRealBoostBins(T=1024, B=8, outliers_ratio=0.05, logit_max: 2.0, fit_mode='numba_cuda', decision_function_mode='numba_cuda')]
[1: {'time_fit': [5076.955407381058, 1.0], 'time_predict_train': [3.2569236755371094, 3.0751254270698762], 'time_predict_test': [0.25902295112609863, 4.062998598149337], 'acc_train': [0.9998234707191649, 1.0], 'acc_test': [0.9936760004216, 1.0]}]
[about to generate wanted plots]
EXPERIMENT REAL DATA DONE. [time: 15594.668811321259 s, hash string: real_0790809631_20230624]
MAIN-EXPERIMENTER DONE.